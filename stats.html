<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Statistiques</title>
<style>
body{font-family:system-ui;background:#2F4F2F;color:#fff;padding:20px}
.card{background:#fff;color:#000;border-radius:12px;padding:14px;margin-bottom:12px}
.bar{height:10px;background:#60a5fa;border-radius:999px}
</style>
</head>

<body>
<a href="index.html">‚Üê Nouvelle vente</a> |
<a href="saved.html">üßæ Toutes les ventes</a>

<h1>Statistiques</h1>
<div id="stats"></div>

<script>
const stats=document.getElementById('stats');
const data=JSON.parse(localStorage.getItem('savedSnapshots')||'[]');

let totalNet=0, count=0;
const byCat={};

data.forEach(s=>{
  const disc=(s.discount||0)/(s.entries.length||1);
  s.entries.forEach(e=>{
    const net=Math.max(e.price-disc,0);
    totalNet+=net; count++;
    byCat[e.category]=(byCat[e.category]||0)+net;
  });
});

stats.innerHTML=`
<div class="card">
  <h3>Total NET</h3>
  <strong>CHF ${totalNet.toFixed(2)}</strong><br>
  Disques vendus: ${count}
</div>
<div class="card">
  <h3>Par cat√©gorie</h3>
  ${Object.entries(byCat).map(([k,v])=>`
    <div>${k}: CHF ${v.toFixed(2)}
      <div class="bar" style="width:${(v/totalNet*100).toFixed(0)}%"></div>
    </div>`).join('')}
</div>`;
</script>
</body>
</html>
