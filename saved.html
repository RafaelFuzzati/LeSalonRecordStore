<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>Toutes les ventes</title>
<style>
body{font-family:system-ui;background:#2F4F2F;color:#fff;padding:20px}
.snapshot{background:#fff;color:#000;padding:12px;border-radius:10px;margin-bottom:12px}
table{width:100%;border-collapse:collapse;margin-top:8px}
th,td{border:1px solid #ccc;padding:6px;text-align:center}
th{background:#007AFF;color:#fff}
.total{font-weight:700;text-align:right;margin-top:6px}
a{color:#7dd3fc}
</style>
</head>

<body>
<a href="index.html">‚Üê Nouvelle vente</a> |
<a href="stats.html">üìä Statistiques</a>

<h1>Toutes les ventes</h1>
<div id="list"></div>

<script>
const list=document.getElementById('list');
const data=JSON.parse(localStorage.getItem('savedSnapshots')||'[]');

if(!data.length){list.textContent="Aucune vente.";return;}

data.slice().reverse().forEach(s=>{
  let sum=0;
  s.entries.forEach(e=>sum+=e.price);
  const net=Math.max(sum-(s.discount||0)+(s.tip||0),0);

  const d=new Date(s.time);
  const div=document.createElement('div');
  div.className='snapshot';
  div.innerHTML=`<strong>${d.toLocaleString('fr-CH')}</strong>
    <table><thead><tr><th>Cat.</th><th>Style</th><th>CHF</th></tr></thead>
    <tbody>${s.entries.map(e=>`<tr><td>${e.category}</td><td>${e.style}</td><td>${e.price}</td></tr>`).join('')}</tbody>
    </table>
    <div class="total">Rabais: ${s.discount||0} ¬∑ Pourboire: ${s.tip||0}<br>NET: CHF ${net}</div>`;
  list.appendChild(div);
});
</script>
</body>
</html>
